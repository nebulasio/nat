CiAL0DqSfFKONOqRI36KmEPBhCBXibwAcfa2AJK130imexIaGVcbjfHXBl0fnDap3sbXNtJSwGWxPjmxY9UaGhlXG43x1wZdH5w2qd7G1zbSUsBlsT45sWPVIhAAAAAAAAAAAAAAAAAAAAAAKDswz7WA5qotOrNNCgZkZXBsb3kSqE17IlNvdXJjZVR5cGUiOiAianMiLCAiU291cmNlIjogIid1c2Ugc3RyaWN0JztcblxudmFyIEFsbG93ZWQgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgdGhpcy5hbGxvd2VkID0ge307XG4gICAgdGhpcy5wYXJzZShvYmopO1xufVxuXG5BbGxvd2VkLnByb3RvdHlwZSA9IHtcbiAgICB0b1N0cmluZzogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy5hbGxvd2VkKTtcbiAgICB9LFxuXG4gICAgcGFyc2U6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgaWYgKHR5cGVvZiBvYmogIT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKG9iaik7XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGF0YSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWxsb3dlZFtrZXldID0gbmV3IEJpZ051bWJlcihkYXRhW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIGdldDogZnVuY3Rpb24gKGtleSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hbGxvd2VkW2tleV07XG4gICAgfSxcblxuICAgIHNldDogZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5hbGxvd2VkW2tleV0gPSBuZXcgQmlnTnVtYmVyKHZhbHVlKTtcbiAgICB9XG59XG5cbnZhciBOQVRUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLl9jb250cmFjdE5hbWUgPSBcIk5BVFRva2VuXCI7XG4gICAgTG9jYWxDb250cmFjdFN0b3JhZ2UuZGVmaW5lUHJvcGVydGllcyh0aGlzLCB7XG4gICAgICAgIF9uYW1lOiBudWxsLFxuICAgICAgICBfc3ltYm9sOiBudWxsLFxuICAgICAgICBfZGVjaW1hbHM6IG51bGwsXG4gICAgICAgIF90b3RhbFN1cHBseToge1xuICAgICAgICAgICAgcGFyc2U6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQmlnTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdHJpbmdpZnk6IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG8udG9TdHJpbmcoMTApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfbXVsdGlTaWc6IG51bGwsXG4gICAgICAgIF9kaXN0cmlidXRlOiBudWxsLFxuICAgICAgICBfY29uZmlnOiBudWxsLFxuICAgICAgICBfYmxhY2tsaXN0OiBudWxsXG4gICAgfSk7XG5cbiAgICBMb2NhbENvbnRyYWN0U3RvcmFnZS5kZWZpbmVNYXBQcm9wZXJ0aWVzKHRoaXMsIHtcbiAgICAgICAgXCJfYmFsYW5jZXNcIjoge1xuICAgICAgICAgICAgcGFyc2U6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQmlnTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdHJpbmdpZnk6IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG8udG9TdHJpbmcoMTApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcIl9hbGxvd2VkXCI6IHtcbiAgICAgICAgICAgIHBhcnNlOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFsbG93ZWQodmFsdWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN0cmluZ2lmeTogZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gby50b1N0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59O1xuXG5OQVRUb2tlbi5wcm90b3R5cGUgPSB7XG4gICAgaW5pdDogZnVuY3Rpb24gKG5hbWUsIHN5bWJvbCwgZGVjaW1hbHMsIG11bHRpU2lnKSB7XG4gICAgICAgIHRoaXMuX25hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLl9zeW1ib2wgPSBzeW1ib2w7XG4gICAgICAgIHRoaXMuX2RlY2ltYWxzID0gZGVjaW1hbHMgfHwgMDtcbiAgICAgICAgdGhpcy5fdG90YWxTdXBwbHkgPSBuZXcgQmlnTnVtYmVyKDApO1xuICAgICAgICB0aGlzLl9tdWx0aVNpZyA9IG11bHRpU2lnO1xuICAgICAgICB0aGlzLl9ibGFja2xpc3QgPSBbXTtcbiAgICB9LFxuXG4gICAgIF92ZXJpZnlQZXJtaXNzaW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9tdWx0aVNpZyAhPT0gQmxvY2tjaGFpbi50cmFuc2FjdGlvbi5mcm9tKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQZXJtaXNzaW9uIERlbmllZCFcIik7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgc2V0Q29uZmlnOiBmdW5jdGlvbihuYXRDb25maWcpIHtcbiAgICAgICAgdGhpcy5fdmVyaWZ5UGVybWlzc2lvbigpO1xuICAgICAgICB0aGlzLl9jb25maWcgPSBuYXRDb25maWc7XG4gICAgICAgIHRoaXMuX211bHRpU2lnID0gbmF0Q29uZmlnLm11bHRpU2lnO1xuICAgICAgICB0aGlzLl9kaXN0cmlidXRlID0gbmF0Q29uZmlnLmRpc3RyaWJ1dGU7XG4gICAgfSxcblxuICAgIHNldEJsYWNrbGlzdDogZnVuY3Rpb24oYmxhY2tsaXN0KSB7XG4gICAgICAgIHRoaXMuX3ZlcmlmeVBlcm1pc3Npb24oKTtcbiAgICAgICAgdGhpcy5fYmxhY2tsaXN0ID0gYmxhY2tsaXN0O1xuICAgIH0sXG5cbiAgICBibGFja2xpc3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYmxhY2tsaXN0O1xuICAgIH0sXG5cbiAgICBfdmVyaWZ5QmxhY2tsaXN0OiBmdW5jdGlvbihhZGRyKSB7XG4gICAgICAgIGlmICh0aGlzLl9ibGFja2xpc3QuaW5kZXhPZihhZGRyKSA+PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBZGRyZXNzIGlzIG5vdCBhbGxvd2VkIGZvciB0cmFuc2FjdGlvbi5cIik7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgX3ZlcmlmeUFkZHJlc3M6IGZ1bmN0aW9uIChhZGRyZXNzKSB7XG4gICAgICAgIGlmIChCbG9ja2NoYWluLnZlcmlmeUFkZHJlc3MoYWRkcmVzcykgPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFkZHJlc3MgZm9ybWF0IGVycm9yLCBhZGRyZXNzPVwiICsgYWRkcmVzcyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgX3ZlcmlmeVZhbHVlOiBmdW5jdGlvbih2YWx1ZSwgY2hlY2tOZWdhdGl2ZSkge1xuICAgICAgICBsZXQgYmlnVmFsID0gbmV3IEJpZ051bWJlcih2YWx1ZSk7XG4gICAgICAgIGlmIChiaWdWYWwuaXNOYU4oKSB8fCAhYmlnVmFsLmlzRmluaXRlKCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWUsIHZhbHVlPVwiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGVja05lZ2F0aXZlICYmIGJpZ1ZhbC5pc05lZ2F0aXZlKCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlIGlzIG5lZ2F0aXZlLCB2YWx1ZT1cIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBwcm9kdWNlOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIC8vIHBlcm1pc3Npb24gY2hlY2tcbiAgICAgICAgaWYgKHRoaXMuX2Rpc3RyaWJ1dGUgIT09IEJsb2NrY2hhaW4udHJhbnNhY3Rpb24uZnJvbSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGVybWlzc2lvbiBEZW5pZWQgZm9yIGRpc3RyaWJ1dGUhXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCEoZGF0YSBpbnN0YW5jZW9mIEFycmF5KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRGF0YSBmb3JtYXQgZXJyb3IuXCIpXG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdG90YWwgPSBuZXcgQmlnTnVtYmVyKDApO1xuICAgICAgICBmb3IgKGxldCBrZXkgaW4gZGF0YSkge1xuICAgICAgICAgICAgbGV0IGl0ZW0gPSBkYXRhW2tleV07XG4gICAgICAgICAgICB0aGlzLl92ZXJpZnlBZGRyZXNzKGl0ZW0uYWRkcik7XG4gICAgICAgICAgICB0aGlzLl92ZXJpZnlWYWx1ZShpdGVtLnZhbHVlLCBmYWxzZSk7XG5cbiAgICAgICAgICAgIGxldCBiYWxhbmNlID0gdGhpcy5fYmFsYW5jZXMuZ2V0KGl0ZW0uYWRkcikgfHwgbmV3IEJpZ051bWJlcigwKTtcbiAgICAgICAgICAgIC8vIGJhbGFuY2UgKyB2YWx1ZVxuICAgICAgICAgICAgdG90YWwgPSB0b3RhbC5wbHVzKGl0ZW0udmFsdWUpO1xuICAgICAgICAgICAgYmFsYW5jZSA9IGJhbGFuY2UucGx1cyhpdGVtLnZhbHVlKTtcblxuICAgICAgICAgICAgaWYgKGJhbGFuY2UubHQoMCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9kdWNlRXZlbnQoZmFsc2UsIHRoaXMuX3RvdGFsU3VwcGx5LCBkYXRhKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcm9kdWNlIGZhaWxlZC5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9iYWxhbmNlcy5zZXQoaXRlbS5hZGRyLCBiYWxhbmNlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90b3RhbFN1cHBseSA9IHRoaXMuX3RvdGFsU3VwcGx5LnBsdXModG90YWwpO1xuICAgICAgICB0aGlzLl9wcm9kdWNlRXZlbnQodHJ1ZSwgdGhpcy5fdG90YWxTdXBwbHksIGRhdGEpO1xuICAgIH0sXG5cbiAgICBfcHJvZHVjZUV2ZW50OiBmdW5jdGlvbiAoc3RhdHVzLCB0b3RhbCwgZGF0YSkge1xuICAgICAgICBFdmVudC5UcmlnZ2VyKHRoaXMubmFtZSgpLCB7XG4gICAgICAgICAgICBTdGF0dXM6IHN0YXR1cyxcbiAgICAgICAgICAgIFByb2R1Y2U6IHtcbiAgICAgICAgICAgICAgICB0b3RhbDogdG90YWwudG9TdHJpbmcoMTApLFxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGFcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8vIFJldHVybnMgdGhlIG5hbWUgb2YgdGhlIHRva2VuXG4gICAgbmFtZTogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbmFtZTtcbiAgICB9LFxuXG4gICAgLy8gUmV0dXJucyB0aGUgc3ltYm9sIG9mIHRoZSB0b2tlblxuICAgIHN5bWJvbDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3ltYm9sO1xuICAgIH0sXG5cbiAgICAvLyBSZXR1cm5zIHRoZSBudW1iZXIgb2YgZGVjaW1hbHMgdGhlIHRva2VuIHVzZXNcbiAgICBkZWNpbWFsczogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGVjaW1hbHM7XG4gICAgfSxcblxuICAgIHRvdGFsU3VwcGx5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90b3RhbFN1cHBseS50b1N0cmluZygxMCk7XG4gICAgfSxcblxuICAgIG1hbmFnZXJzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21hbmFnZXJzO1xuICAgIH0sXG5cbiAgICBwcm9kdWNlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wcm9kdWNlcjtcbiAgICB9LFxuXG4gICAgYmFsYW5jZU9mOiBmdW5jdGlvbiAob3duZXIpIHtcbiAgICAgICAgdmFyIGJhbGFuY2UgPSB0aGlzLl9iYWxhbmNlcy5nZXQob3duZXIpO1xuXG4gICAgICAgIGlmIChiYWxhbmNlIGluc3RhbmNlb2YgQmlnTnVtYmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gYmFsYW5jZS50b1N0cmluZygxMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCIwXCI7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgdHJhbnNmZXI6IGZ1bmN0aW9uICh0bywgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5fdmVyaWZ5QmxhY2tsaXN0KEJsb2NrY2hhaW4udHJhbnNhY3Rpb24uZnJvbSk7XG4gICAgICAgIHRoaXMuX3ZlcmlmeUFkZHJlc3ModG8pO1xuICAgICAgICB0aGlzLl92ZXJpZnlWYWx1ZSh2YWx1ZSwgdHJ1ZSk7XG5cbiAgICAgICAgdmFyIGZyb20gPSBCbG9ja2NoYWluLnRyYW5zYWN0aW9uLmZyb207XG4gICAgICAgIHZhciBiYWxhbmNlID0gdGhpcy5fYmFsYW5jZXMuZ2V0KGZyb20pIHx8IG5ldyBCaWdOdW1iZXIoMCk7XG5cbiAgICAgICAgaWYgKGJhbGFuY2UubHQodmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUcmFuc2ZlciBGYWlsZWQuXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fYmFsYW5jZXMuc2V0KGZyb20sIGJhbGFuY2Uuc3ViKHZhbHVlKSk7XG4gICAgICAgIHZhciB0b0JhbGFuY2UgPSB0aGlzLl9iYWxhbmNlcy5nZXQodG8pIHx8IG5ldyBCaWdOdW1iZXIoMCk7XG4gICAgICAgIHRoaXMuX2JhbGFuY2VzLnNldCh0bywgdG9CYWxhbmNlLmFkZCh2YWx1ZSkpO1xuXG4gICAgICAgIHRoaXMuX3RyYW5zZmVyRXZlbnQodHJ1ZSwgZnJvbSwgdG8sIHZhbHVlKTtcbiAgICB9LFxuXG4gICAgdHJhbnNmZXJGcm9tOiBmdW5jdGlvbiAoZnJvbSwgdG8sIHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3ZlcmlmeUJsYWNrbGlzdChmcm9tKTtcbiAgICAgICAgdGhpcy5fdmVyaWZ5QWRkcmVzcyhmcm9tKTtcbiAgICAgICAgdGhpcy5fdmVyaWZ5QWRkcmVzcyh0byk7XG4gICAgICAgIHRoaXMuX3ZlcmlmeVZhbHVlKHZhbHVlLCB0cnVlKTtcblxuICAgICAgICB2YXIgc3BlbmRlciA9IEJsb2NrY2hhaW4udHJhbnNhY3Rpb24uZnJvbTtcbiAgICAgICAgdmFyIGJhbGFuY2UgPSB0aGlzLl9iYWxhbmNlcy5nZXQoZnJvbSkgfHwgbmV3IEJpZ051bWJlcigwKTtcblxuICAgICAgICB2YXIgYWxsb3dlZCA9IHRoaXMuX2FsbG93ZWQuZ2V0KGZyb20pIHx8IG5ldyBBbGxvd2VkKCk7XG4gICAgICAgIHZhciBhbGxvd2VkVmFsdWUgPSBhbGxvd2VkLmdldChzcGVuZGVyKSB8fCBuZXcgQmlnTnVtYmVyKDApO1xuICAgICAgICB2YWx1ZSA9IG5ldyBCaWdOdW1iZXIodmFsdWUpO1xuXG4gICAgICAgIGlmICh2YWx1ZS5ndGUoMCkgJiYgYmFsYW5jZS5ndGUodmFsdWUpICYmIGFsbG93ZWRWYWx1ZS5ndGUodmFsdWUpKSB7XG5cbiAgICAgICAgICAgIHRoaXMuX2JhbGFuY2VzLnNldChmcm9tLCBiYWxhbmNlLnN1Yih2YWx1ZSkpO1xuXG4gICAgICAgICAgICAvLyB1cGRhdGUgYWxsb3dlZCB2YWx1ZVxuICAgICAgICAgICAgYWxsb3dlZC5zZXQoc3BlbmRlciwgYWxsb3dlZFZhbHVlLnN1Yih2YWx1ZSkpO1xuICAgICAgICAgICAgdGhpcy5fYWxsb3dlZC5zZXQoZnJvbSwgYWxsb3dlZCk7XG5cbiAgICAgICAgICAgIHZhciB0b0JhbGFuY2UgPSB0aGlzLl9iYWxhbmNlcy5nZXQodG8pIHx8IG5ldyBCaWdOdW1iZXIoMCk7XG4gICAgICAgICAgICB0aGlzLl9iYWxhbmNlcy5zZXQodG8sIHRvQmFsYW5jZS5hZGQodmFsdWUpKTtcblxuICAgICAgICAgICAgdGhpcy5fdHJhbnNmZXJFdmVudCh0cnVlLCBmcm9tLCB0bywgdmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVHJhbnNmZXIgZmFpbGVkLlwiKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfdHJhbnNmZXJFdmVudDogZnVuY3Rpb24gKHN0YXR1cywgZnJvbSwgdG8sIHZhbHVlKSB7XG4gICAgICAgIEV2ZW50LlRyaWdnZXIodGhpcy5uYW1lKCksIHtcbiAgICAgICAgICAgIFN0YXR1czogc3RhdHVzLFxuICAgICAgICAgICAgVHJhbnNmZXI6IHtcbiAgICAgICAgICAgICAgICBmcm9tOiBmcm9tLFxuICAgICAgICAgICAgICAgIHRvOiB0byxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIGFwcHJvdmU6IGZ1bmN0aW9uIChzcGVuZGVyLCBjdXJyZW50VmFsdWUsIHZhbHVlKSB7XG4gICAgICAgIHZhciBmcm9tID0gQmxvY2tjaGFpbi50cmFuc2FjdGlvbi5mcm9tO1xuICAgICAgICB0aGlzLl92ZXJpZnlCbGFja2xpc3QoZnJvbSk7XG4gICAgICAgIHRoaXMuX3ZlcmlmeUFkZHJlc3Moc3BlbmRlcik7XG4gICAgICAgIHRoaXMuX3ZlcmlmeVZhbHVlKGN1cnJlbnRWYWx1ZSwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuX3ZlcmlmeVZhbHVlKHZhbHVlLCB0cnVlKTtcblxuICAgICAgICB2YXIgb2xkVmFsdWUgPSB0aGlzLmFsbG93YW5jZShmcm9tLCBzcGVuZGVyKTtcbiAgICAgICAgaWYgKG9sZFZhbHVlICE9IGN1cnJlbnRWYWx1ZS50b1N0cmluZygpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDdXJyZW50IGFwcHJvdmUgdmFsdWUgbWlzdGFrZS5cIik7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgYmFsYW5jZSA9IG5ldyBCaWdOdW1iZXIodGhpcy5iYWxhbmNlT2YoZnJvbSkpO1xuICAgICAgICB2YXIgdmFsdWUgPSBuZXcgQmlnTnVtYmVyKHZhbHVlKTtcblxuICAgICAgICBpZiAodmFsdWUubHQoMCkgfHwgYmFsYW5jZS5sdCh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWUuXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIG93bmVkID0gdGhpcy5fYWxsb3dlZC5nZXQoZnJvbSkgfHwgbmV3IEFsbG93ZWQoKTtcbiAgICAgICAgb3duZWQuc2V0KHNwZW5kZXIsIHZhbHVlKTtcblxuICAgICAgICB0aGlzLl9hbGxvd2VkLnNldChmcm9tLCBvd25lZCk7XG5cbiAgICAgICAgdGhpcy5fYXBwcm92ZUV2ZW50KHRydWUsIGZyb20sIHNwZW5kZXIsIHZhbHVlKTtcbiAgICB9LFxuXG4gICAgX2FwcHJvdmVFdmVudDogZnVuY3Rpb24gKHN0YXR1cywgZnJvbSwgc3BlbmRlciwgdmFsdWUpIHtcbiAgICAgICAgRXZlbnQuVHJpZ2dlcih0aGlzLm5hbWUoKSwge1xuICAgICAgICAgICAgU3RhdHVzOiBzdGF0dXMsXG4gICAgICAgICAgICBBcHByb3ZlOiB7XG4gICAgICAgICAgICAgICAgb3duZXI6IGZyb20sXG4gICAgICAgICAgICAgICAgc3BlbmRlcjogc3BlbmRlcixcbiAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIGFsbG93YW5jZTogZnVuY3Rpb24gKG93bmVyLCBzcGVuZGVyKSB7XG4gICAgICAgIHZhciBvd25lZCA9IHRoaXMuX2FsbG93ZWQuZ2V0KG93bmVyKTtcblxuICAgICAgICBpZiAob3duZWQgaW5zdGFuY2VvZiBBbGxvd2VkKSB7XG4gICAgICAgICAgICB2YXIgc3BlbmRlciA9IG93bmVkLmdldChzcGVuZGVyKTtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3BlbmRlciAhPSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNwZW5kZXIudG9TdHJpbmcoMTApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBcIjBcIjtcbiAgICB9LFxuXG4gICAgd2l0aGRyYXc6IGZ1bmN0aW9uKGFkZHIpIHtcbiAgICAgICAgdGhpcy5fdmVyaWZ5UGVybWlzc2lvbigpO1xuICAgICAgICB0aGlzLl92ZXJpZnlBZGRyZXNzKGFkZHIpO1xuXG4gICAgICAgIGxldCBiYWxhbmNlID0gQmxvY2tjaGFpbi5nZXRBY2NvdW50U3RhdGUoQmxvY2tjaGFpbi50cmFuc2FjdGlvbi50bykuYmFsYW5jZTtcbiAgICAgICAgaWYgKG5ldyBCaWdOdW1iZXIoYmFsYW5jZSkuZ3QoMCkpIHtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBCbG9ja2NoYWluLnRyYW5zZmVyKGFkZHIsIGJhbGFuY2UpO1xuICAgICAgICAgICAgdGhpcy5fd2l0aGRyYXdFdmVudChyZXN1bHQsIEJsb2NrY2hhaW4udHJhbnNhY3Rpb24udG8sIGFkZHIsIGJhbGFuY2UpO1xuICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJXaXRoZHJhdyBmYWlsZWQuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIF93aXRoZHJhd0V2ZW50OiBmdW5jdGlvbiAoc3RhdHVzLCBmcm9tLCB0bywgdmFsdWUpIHtcbiAgICAgICAgRXZlbnQuVHJpZ2dlcih0aGlzLm5hbWUoKSwge1xuICAgICAgICAgICAgU3RhdHVzOiBzdGF0dXMsXG4gICAgICAgICAgICBXaXRoZHJhdzoge1xuICAgICAgICAgICAgICAgIGZyb206IGZyb20sXG4gICAgICAgICAgICAgICAgdG86IHRvLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE5BVFRva2VuO1xuIiwgIkFyZ3MiOiAiW1wiTkFUVG9rZW5cIiwgXCJOQVRcIiwgMTgsIFwibjFzeDJEVXBIb1d0c0dYcmh1cHVDQ3hVeGV1V2tZcnFWNWtcIl0ifUDXCEoQAAAAAAAAAAAAAAAEqBfIAFIQAAAAAAAAAAAAAAAAAAMNQFgBYkFXyI/pQs5Ub0+hELFU0CvhFNim9Bu8lHwvq7WxMJ0lBy6P2wvqc0zpIBhNHT3cBCE05rJlpHvMykne2f3V0jYcAA==