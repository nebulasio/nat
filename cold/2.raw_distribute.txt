CiBzzOBG8iCeacrgv9BctEzd7P9DOsdXph2IG0/mz01pEBIaGVcbjfHXBl0fnDap3sbXNtJSwGWxPjmxY9UaGhlXG43x1wZdH5w2qd7G1zbSUsBlsT45sWPVIhAAAAAAAAAAAAAAAAAAAAAAKDww1bWA5qotOoxQCgZkZXBsb3kSgVB7IlNvdXJjZVR5cGUiOiAianMiLCAiU291cmNlIjogImNvbnN0IFNUQVRFX1dPUksgPSAwO1xuY29uc3QgU1RBVEVfUEFVU0VEID0gMTtcbmNvbnN0IEhFSUdIVF9JTlRFUlZBTCA9IDMwOyAvLyA0MDMyMFxuXG5mdW5jdGlvbiBEUGxlZGdlKCkge1xuICAgIExvY2FsQ29udHJhY3RTdG9yYWdlLmRlZmluZVByb3BlcnRpZXModGhpcywge1xuICAgICAgICBfcGxlZGdlX3BlcmlvZDogbnVsbCxcbiAgICAgICAgX3BsZWRnZV9wYWdlOiBudWxsLFxuICAgICAgICBfcGxlZGdlX2hlaWdodDogbnVsbCxcbiAgICAgICAgX3BsZWRnZV9jb250cmFjdDogbnVsbFxuICAgIH0pO1xufTtcblxuRFBsZWRnZS5wcm90b3R5cGUgPSB7XG4gICAgdXBkYXRlX2NvbnRyYWN0OiBmdW5jdGlvbihjb250cmFjdCkge1xuICAgICAgICB0aGlzLl9wbGVkZ2VfY29udHJhY3QgPSBjb250cmFjdDtcbiAgICB9LFxuICAgIGNhbGN1bGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGxldCBwbGVkZ2UgPSBuZXcgQmxvY2tjaGFpbi5Db250cmFjdCh0aGlzLl9wbGVkZ2VfY29udHJhY3QpO1xuICAgICAgICBsZXQgc3RhcnQgPSB0aGlzLl9wbGVkZ2VfaGVpZ2h0O1xuICAgICAgICBsZXQgZW5kID0gdGhpcy5fcGxlZGdlX2hlaWdodCArIEhFSUdIVF9JTlRFUlZBTCAtIDE7XG4gICAgICAgIGlmIChlbmQgPiBCbG9ja2NoYWluLmJsb2NrLmhlaWdodCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGxlZGdlIHBlcmlvZCBleGNlZWRzIHRoZSBjdXJyZW50IGhlaWdodC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHBhZ2UgPSB0aGlzLl9wbGVkZ2VfcGFnZTtcbiAgICAgICAgbGV0IHBsZWRnZURhdGEgPSBwbGVkZ2UuY2FsbChcImdldFBsZWRnZVwiLCBzdGFydCwgZW5kLCBwYWdlKTtcbiAgICAgICAgaWYgKHBsZWRnZURhdGEgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIFBsZWRnZSBEYXRhIEZvdW5kLlwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBkYXRhID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGZvciAobGV0IGtleSBpbiBwbGVkZ2VEYXRhLmRhdGEpIHtcbiAgICAgICAgICAgIGxldCBpdGVtID0gcGxlZGdlRGF0YS5kYXRhW2tleV07XG4gICAgICAgICAgICAvLyA1ICogMTIuNjYzICogeCAvICgxICsgc3FydCgyMDAveCkpICogMC45OTdeaVxuICAgICAgICAgICAgbGV0IGd4ID0gbmV3IEJpZ051bWJlcigxMi42NjMpLnRpbWVzKGl0ZW0udmFsdWUpO1xuICAgICAgICAgICAgbGV0IHp4ID0gbmV3IEJpZ051bWJlcigyMDApLmRpdihpdGVtLnZhbHVlKS5zcXJ0KCkucGx1cygxKS5wb3coLTEpO1xuICAgICAgICAgICAgbGV0IHkgPSBuZXcgQmlnTnVtYmVyKDAuOTk3KS5wb3codGhpcy5fcGxlZGdlX3BlcmlvZCk7XG4gICAgICAgICAgICBsZXQgdmFsdWUgPSBuZXcgQmlnTnVtYmVyKDUpLnRpbWVzKGd4KS50aW1lcyh6eCkudGltZXMoeSk7XG4gICAgICAgICAgICBpdGVtLm5hdCA9IHZhbHVlLnRvU3RyaW5nKDEwKTtcbiAgICAgICAgICAgIGRhdGEucHVzaChpdGVtKTtcbiAgICAgICAgfVxuICAgICAgICBwbGVkZ2UuY2FsbChcInNldFBsZWRnZVJlc3VsdFwiLCBzdGFydCwgZW5kLCBkYXRhKTtcbiAgICAgICAgdGhpcy5fdHJpZ2dlcl9ldmVudChzdGFydCwgZW5kLCBkYXRhKTtcbiAgICAgICAgaWYgKHBsZWRnZURhdGEuaGFzTmV4dCkge1xuICAgICAgICAgICAgdGhpcy5fcGxlZGdlX3BhZ2UgPSBwYWdlICsgMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3BsZWRnZV9wZXJpb2QgPSB0aGlzLl9wbGVkZ2VfcGVyaW9kICsgMTtcbiAgICAgICAgICAgIHRoaXMuX3BsZWRnZV9oZWlnaHQgPSBlbmQgKyAxO1xuICAgICAgICAgICAgdGhpcy5fcGxlZGdlX3BhZ2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7aGFzTmV4dDogcGxlZGdlRGF0YS5oYXNOZXh0LCBkYXRhOiBkYXRhfTtcbiAgICB9LFxuICAgIF90cmlnZ2VyX2V2ZW50OiBmdW5jdGlvbihzdGFydCwgZW5kLCBwYWdlLCBkYXRhKSB7XG4gICAgICAgIEV2ZW50LlRyaWdnZXIoXCJwbGVkZ2VcIiwge1xuICAgICAgICAgICAgICAgIHBlcmlvZDogdGhpcy5fcGxlZGdlX3BlcmlvZCxcbiAgICAgICAgICAgICAgICBzdGFydF9oZWlnaHQ6IHN0YXJ0LFxuICAgICAgICAgICAgICAgIGVuZF9oZWlnaHQ6IGVuZCxcbiAgICAgICAgICAgICAgICBwYWdlOiBwYWdlLFxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGFcbiAgICAgICAgfSk7XG4gICAgfVxufTtcblxuZnVuY3Rpb24gRE5SKCkge1xuICAgIExvY2FsQ29udHJhY3RTdG9yYWdlLmRlZmluZVByb3BlcnRpZXModGhpcywge1xuICAgICAgICBfbnJfcGVyaW9kOiBudWxsLFxuICAgICAgICBfbnJfcGFnZTogbnVsbCxcbiAgICAgICAgX25yX2hlaWdodDogbnVsbCxcbiAgICAgICAgX25yX2NvbnRyYWN0OiBudWxsXG4gICAgfSk7XG59O1xuXG5ETlIucHJvdG90eXBlID0ge1xuICAgIHVwZGF0ZV9jb250cmFjdDogZnVuY3Rpb24oY29udHJhY3QpIHtcbiAgICAgICAgdGhpcy5fbnJfY29udHJhY3QgPSBjb250cmFjdDtcbiAgICB9LFxuICAgIGNhbGN1bGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGxldCBuciA9IG5ldyBCbG9ja2NoYWluLkNvbnRyYWN0KHRoaXMuX25yX2NvbnRyYWN0KTtcbiAgICAgICAgbGV0IHBhZ2UgPSB0aGlzLl9ucl9wYWdlO1xuICAgICAgICBsZXQgbnJEYXRhID0gbnIuY2FsbChcImdldE5SXCIsIHRoaXMuX25yX2hlaWdodCwgdGhpcy5fbnJfcGFnZSk7XG4gICAgICAgIGlmIChuckRhdGEgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIE5SIERhdGEgRm91bmQuXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGRhdGEgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgZm9yIChsZXQga2V5IGluIG5yRGF0YS5kYXRhKSB7XG4gICAgICAgICAgICBsZXQgaXRlbSA9IG5yRGF0YS5kYXRhW2tleV07XG4gICAgICAgICAgICBsZXQgdmFsdWUgPSB0aGlzLl9jYWxjdWxhdGVOQVQoaXRlbS5zY29yZSk7XG4gICAgICAgICAgICBpdGVtLm5hdCA9IHZhbHVlLnRvU3RyaW5nKDEwKTtcbiAgICAgICAgICAgIGRhdGEucHVzaChpdGVtKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90cmlnZ2VyX2V2ZW50KG5yRGF0YS5zZWN0aW9uLCBwYWdlLCBkYXRhKTtcbiAgICAgICAgaWYgKG5yRGF0YS5oYXNOZXh0KSB7XG4gICAgICAgICAgICB0aGlzLl9ucl9wYWdlID0gcGFnZSArIDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9ucl9wZXJpb2QgPSB0aGlzLl9ucl9wZXJpb2QgKyAxO1xuICAgICAgICAgICAgdGhpcy5fbnJfaGVpZ2h0ID0gbnJEYXRhLnNlY3Rpb24uZW5kSGVpZ2h0O1xuICAgICAgICAgICAgdGhpcy5fbnJfcGFnZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtoYXNOZXh0OiBuckRhdGEuaGFzTmV4dCwgZGF0YTogZGF0YX07XG4gICAgfSxcbiAgICAvLyAxMi42NjMgKiAwLjk5N15pICogeFxuICAgIF9jYWxjdWxhdGVOQVQ6IGZ1bmN0aW9uIChzY29yZSkge1xuICAgICAgICBsZXQgdmFsdWUgPSBuZXcgQmlnTnVtYmVyKDEyLjY2MykudGltZXMoc2NvcmUpO1xuICAgICAgICBsZXQgeSA9IG5ldyBCaWdOdW1iZXIoMC45OTcpLnBvdyh0aGlzLl9ucl9wZXJpb2QpO1xuICAgICAgICB2YWx1ZSA9IHZhbHVlLnRpbWVzKHkpO1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICBfdHJpZ2dlcl9ldmVudDogZnVuY3Rpb24oc2VjdGlvbiwgcGFnZSwgZGF0YSkge1xuICAgICAgICBFdmVudC5UcmlnZ2VyKFwibnJcIiwge1xuICAgICAgICAgICAgICAgIHBlcmlvZDogdGhpcy5fbnJfcGVyaW9kLFxuICAgICAgICAgICAgICAgIHBhZ2U6IHBhZ2UsXG4gICAgICAgICAgICAgICAgc3RhcnRfaGVpZ2h0OiBzZWN0aW9uLnN0YXJ0SGVpZ2h0LFxuICAgICAgICAgICAgICAgIGVuZF9oZWlnaHQ6IHNlY3Rpb24uZW5kSGVpZ2h0LFxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGFcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn07XG5cbmZ1bmN0aW9uIERWb3RlKCkge1xuICAgIExvY2FsQ29udHJhY3RTdG9yYWdlLmRlZmluZVByb3BlcnRpZXModGhpcywge1xuICAgICAgICBfdm90ZV9jb250cmFjdHM6IG51bGwsXG4gICAgICAgIF92b3RlX3RheF9hZGRyOiBudWxsXG4gICAgfSk7XG5cbiAgICAvLyB2b3RlIG5yIGRhdGEgcmVjb3JkXG4gICAgLy8ga2V5OmFkZHJcbiAgICAvLyB2YWx1ZTogcGVyaW9kOnZhbHVlXG4gICAgTG9jYWxDb250cmFjdFN0b3JhZ2UuZGVmaW5lTWFwUHJvcGVydGllcyh0aGlzLCB7XG4gICAgICAgIF92b3RlX25yX2RhdGE6IG51bGxcbiAgICB9KTtcbn07XG5cbkRWb3RlLnByb3RvdHlwZSA9IHtcbiAgICB1cGRhdGVfY29udHJhY3Q6IGZ1bmN0aW9uKGNvbnRyYWN0LCB0YXhBZGRyKSB7XG4gICAgICAgIHRoaXMuX3ZvdGVfY29udHJhY3RzID0gY29udHJhY3Q7XG4gICAgICAgIHRoaXMuX3ZvdGVfdGF4X2FkZHIgPSB0YXhBZGRyO1xuICAgIH0sXG4gICAgX3ZlcmlmeVBlcm1pc3Npb246IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5fdm90ZV9jb250cmFjdHMuaW5kZXhPZihCbG9ja2NoYWluLnRyYW5zYWN0aW9uLmZyb20pIDwgMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gcGVybWlzc2lvbiBmb3Igdm90ZS5cIik7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIC8vIHZvdGUgcnVsZTpcbiAgICAvLyAzJSBnaXZlIHRvIHRoZSBkZXNpZ25hdGVkIHRheCBhZGRyZXNzXG4gICAgLy8gcmV3YXJkIDEwICogbWlue052LCBObnJ9XG4gICAgY2FsY3VsYXRlOiBmdW5jdGlvbihjb250ZXh0LCBhZGRyLCB2YWx1ZSkge1xuICAgICAgICB0aGlzLl92ZXJpZnlQZXJtaXNzaW9uKCk7XG5cbiAgICAgICAgbGV0IGRhdGEgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgbGV0IHRheCA9IG5ldyBCaWdOdW1iZXIodmFsdWUpLnRpbWVzKDAuMDMpO1xuICAgICAgICBkYXRhLnB1c2goe2FkZHI6IHRoaXMuX3ZvdGVfdGF4X2FkZHIsIG5hdDp0YXgudG9TdHJpbmcoMTApfSk7XG5cbiAgICAgICAgbGV0IG5yRGF0YSA9IHRoaXMuX3ZvdGVfbnJfZGF0YS5nZXQoYWRkcik7XG4gICAgICAgIGlmIChuckRhdGEgPT09IG51bGwgfHwgbnJEYXRhLnBlcmlvZCAhPT0gY29udGV4dC5fbnIuX25yX3BlcmlvZCkge1xuICAgICAgICAgICAgbGV0IHNjb3JlID0gXCIwXCI7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHNjb3JlID0gQmxvY2tjaGFpbi5nZXRMYXRlc3ROZWJ1bGFzUmFuayhhZGRyKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBpZiBuciBub3QgZm91bmQsIHVzZSAwXG4gICAgICAgICAgICAgICAgc2NvcmUgPSBcIjBcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChuZXcgQmlnTnVtYmVyKHNjb3JlKS5ndCgwKSkge1xuICAgICAgICAgICAgICAgIC8vIDEyLjY2MyAqIDAuOTk3XmkgKiB4XG4gICAgICAgICAgICAgICAgbGV0IG5yUmV3YXJkID0gY29udGV4dC5fbnIuX2NhbGN1bGF0ZU5BVChzY29yZSk7XG4gICAgICAgICAgICAgICAgbnJEYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBwZXJpb2Q6IGNvbnRleHQuX25yLl9ucl9wZXJpb2QsXG4gICAgICAgICAgICAgICAgICAgIHJld2FyZDogbnJSZXdhcmQudG9TdHJpbmcoMTApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBuckRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgIHBlcmlvZDogY29udGV4dC5fbnIuX25yX3BlcmlvZCxcbiAgICAgICAgICAgICAgICAgICAgcmV3YXJkOiBcIjBcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBsZXQgcmV3YXJkID0gbnVsbDtcbiAgICAgICAgaWYgKG5ldyBCaWdOdW1iZXIobnJEYXRhLnJld2FyZCkuZ3QodmFsdWUpKSB7XG4gICAgICAgICAgICBuckRhdGEucmV3YXJkID0gbmV3IEJpZ051bWJlcihuckRhdGEucmV3YXJkKS5taW51cyh2YWx1ZSkudG9TdHJpbmcoMTApO1xuICAgICAgICAgICAgcmV3YXJkID0gbmV3IEJpZ051bWJlcih2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXdhcmQgPSBuZXcgQmlnTnVtYmVyKG5yRGF0YS5yZXdhcmQpO1xuICAgICAgICAgICAgbnJEYXRhLnJld2FyZCA9IFwiMFwiO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3ZvdGVfbnJfZGF0YS5zZXQoYWRkciwgbnJEYXRhKTtcblxuICAgICAgICBpZiAocmV3YXJkLmd0KDApKSB7XG4gICAgICAgICAgICByZXdhcmQgPSByZXdhcmQudGltZXMoMTApO1xuICAgICAgICB9XG4gICAgICAgIHZhbHVlID0gcmV3YXJkLm1pbnVzKHZhbHVlKTtcblxuICAgICAgICBkYXRhLnB1c2goe2FkZHI6IGFkZHIsIG5hdDogdmFsdWUudG9TdHJpbmcoMTApfSk7XG4gICAgICAgIC8vIHZvdGUgcmV3YXJkXG4gICAgICAgIHRoaXMuX3RyaWdnZXJfZXZlbnQoZGF0YSk7XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH0sXG4gICAgX3RyaWdnZXJfZXZlbnQ6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgRXZlbnQuVHJpZ2dlcihcInZvdGVcIiwgZGF0YSk7XG4gICAgfVxufTtcblxuZnVuY3Rpb24gRGlzdHJpYnV0ZSgpIHtcbiAgICB0aGlzLl9jb250cmFjdE5hbWUgPSBcIkRpc3RyaWJ1dGVcIjtcbiAgICBMb2NhbENvbnRyYWN0U3RvcmFnZS5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMsIHtcbiAgICAgICAgX3N0YXRlOiBudWxsLFxuICAgICAgICBfbmF0X2NvbnRyYWN0OiBudWxsLFxuICAgICAgICBfbXVsdGlTaWc6IG51bGwsXG4gICAgICAgIF9kaXN0cmlidXRlTWFuYWdlcjogbnVsbCxcbiAgICAgICAgX2JsYWNrbGlzdDogbnVsbFxuICAgIH0pO1xuXG4gICAgdGhpcy5fcGxlZGdlID0gbmV3IERQbGVkZ2UoKTtcbiAgICB0aGlzLl9uciA9IG5ldyBETlIoKTtcbiAgICB0aGlzLl92b3RlID0gbmV3IERWb3RlKCk7XG59O1xuXG5EaXN0cmlidXRlLnByb3RvdHlwZSA9IHtcbiAgICBpbml0OiBmdW5jdGlvbiAocGxlZGdlSGVpZ2h0LCBuckhlaWdodCwgbXVsdGlTaWcpIHtcbiAgICAgICAgdGhpcy5fc3RhdGUgPSBTVEFURV9XT1JLO1xuICAgICAgICB0aGlzLl9wbGVkZ2UuX3BsZWRnZV9wZXJpb2QgPSAwO1xuICAgICAgICB0aGlzLl9wbGVkZ2UuX3BsZWRnZV9wYWdlID0gMDtcbiAgICAgICAgdGhpcy5fcGxlZGdlLl9wbGVkZ2VfaGVpZ2h0ID0gcGxlZGdlSGVpZ2h0O1xuICAgICAgICB0aGlzLl9uci5fbnJfcGVyaW9kID0gMDtcbiAgICAgICAgdGhpcy5fbnIuX25yX3BhZ2UgPSAwO1xuICAgICAgICB0aGlzLl9uci5fbnJfaGVpZ2h0ID0gbnJIZWlnaHQ7XG4gICAgICAgIHRoaXMuX3ZvdGUuX3ZvdGVfY29udHJhY3RzID0gW107XG4gICAgICAgIHRoaXMuX211bHRpU2lnID0gbXVsdGlTaWc7XG4gICAgICAgIHRoaXMuX2JsYWNrbGlzdCA9IFtdO1xuICAgIH0sXG4gICAgX3ZlcmlmeVBlcm1pc3Npb246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX211bHRpU2lnICE9PSBCbG9ja2NoYWluLnRyYW5zYWN0aW9uLmZyb20pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBlcm1pc3Npb24gRGVuaWVkIVwiKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgX3ZlcmlmeU1hbmFnZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2Rpc3RyaWJ1dGVNYW5hZ2VyICE9PSBCbG9ja2NoYWluLnRyYW5zYWN0aW9uLmZyb20pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkRpc3RyaWJ1dGUgTWFuYWdlciBQZXJtaXNzaW9uIERlbmllZCFcIik7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIF92ZXJpZnlTdGF0dXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5fc3RhdGUgPT09IFNUQVRFX1BBVVNFRCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRGlzdHJpYnV0ZSBwYXVzZWQuXCIpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBfdmVyaWZ5QmxhY2tsaXN0OiBmdW5jdGlvbihhZGRyKSB7XG4gICAgICAgIGlmICh0aGlzLl9ibGFja2xpc3QuaW5kZXhPZihhZGRyKSA+PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBZGRyZXNzIGlzIG5vdCBhbGxvd2VkIGZvciBkaXN0cmlidXRlLlwiKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgX3Byb2R1Y2VOYXQ6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgbGV0IG5hdCA9IG5ldyBCbG9ja2NoYWluLkNvbnRyYWN0KHRoaXMuX25hdF9jb250cmFjdCk7XG4gICAgICAgIGxldCBuYXREYXRhID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGZvciAobGV0IGtleSBpbiBkYXRhKSB7XG4gICAgICAgICAgICBsZXQgaXRlbSA9IGRhdGFba2V5XTtcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9IG5ldyBCaWdOdW1iZXIoMTApLnBvdygxOCkudGltZXMoaXRlbS5uYXQpLmZsb29yKCk7XG4gICAgICAgICAgICBuYXREYXRhLnB1c2goe2FkZHI6IGl0ZW0uYWRkciwgdmFsdWU6IHZhbHVlLnRvU3RyaW5nKDEwKX0pO1xuICAgICAgICB9XG4gICAgICAgIG5hdC5jYWxsKFwicHJvZHVjZVwiLCBuYXREYXRhKTtcbiAgICB9LFxuXG4gICAgLy8gZm9yIG11bGlzaWcuanNcbiAgICB1cGRhdGVTdGF0dXM6IGZ1bmN0aW9uKHN0YXRlKSB7XG4gICAgICAgIHRoaXMuX3ZlcmlmeVBlcm1pc3Npb24oKTtcbiAgICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcbiAgICB9LFxuICAgIHNldENvbmZpZzogZnVuY3Rpb24obmF0Q29uZmlnKSB7XG4gICAgICAgIHRoaXMuX3ZlcmlmeVBlcm1pc3Npb24oKTtcbiAgICAgICAgdGhpcy5fY29uZmlnID0gbmF0Q29uZmlnO1xuICAgICAgICB0aGlzLl9kaXN0cmlidXRlTWFuYWdlciA9IG5hdENvbmZpZy5kaXN0cmlidXRlTWFuYWdlcjtcbiAgICAgICAgdGhpcy5fbXVsdGlTaWcgPSBuYXRDb25maWcubXVsdGlTaWc7XG4gICAgICAgIHRoaXMuX25hdF9jb250cmFjdCA9IG5hdENvbmZpZy5uYXROUkMyMDtcbiAgICAgICAgdGhpcy5fcGxlZGdlLnVwZGF0ZV9jb250cmFjdChuYXRDb25maWcucGxlZGdlKTtcbiAgICAgICAgdGhpcy5fdm90ZS51cGRhdGVfY29udHJhY3QobmF0Q29uZmlnLnZvdGUsIG5hdENvbmZpZy5kaXN0cmlidXRlVm90ZVRheEFkZHIpO1xuICAgICAgICB0aGlzLl9uci51cGRhdGVfY29udHJhY3QobmF0Q29uZmlnLm5yRGF0YSk7XG4gICAgfSxcblxuICAgIC8vIHVwZGF0ZSBibGFja2xpc3RcbiAgICBzZXRCbGFja2xpc3Q6IGZ1bmN0aW9uKGFkZHJMaXN0KSB7XG4gICAgICAgIHRoaXMuX3ZlcmlmeVBlcm1pc3Npb24oKTtcbiAgICAgICAgdGhpcy5fYmxhY2tsaXN0ID0gYWRkckxpc3Q7XG4gICAgfSwgXG5cbiAgICAvLyB0cmlnZ2VyIHBsZWRnZSByZXdhcmRcbiAgICB0cmlnZ2VyUGxlZGdlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fdmVyaWZ5TWFuYWdlcigpO1xuICAgICAgICB0aGlzLl92ZXJpZnlTdGF0dXMoKTtcblxuICAgICAgICBsZXQgcGxlZGdlID0gdGhpcy5fcGxlZGdlLmNhbGN1bGF0ZSgpO1xuICAgICAgICB0aGlzLl9wcm9kdWNlTmF0KHBsZWRnZS5kYXRhKTtcbiAgICAgICAgcmV0dXJuIHtuZWVkVHJpZ2dlcjogcGxlZGdlLmhhc05leHR9O1xuICAgIH0sXG4gICAgLy8gdHJpZ2dlciBuciByZXdhcmRcbiAgICB0cmlnZ2VyTlI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl92ZXJpZnlNYW5hZ2VyKCk7XG4gICAgICAgIHRoaXMuX3ZlcmlmeVN0YXR1cygpO1xuXG4gICAgICAgIGxldCBuciA9IHRoaXMuX25yLmNhbGN1bGF0ZSgpO1xuICAgICAgICB0aGlzLl9wcm9kdWNlTmF0KG5yLmRhdGEpO1xuICAgICAgICByZXR1cm4ge25lZWRUcmlnZ2VyOiBuci5oYXNOZXh0fTtcbiAgICB9LFxuICAgIC8vIHRyaWdnZXIgdm90ZSByZXdhcmRcbiAgICB2b3RlOiBmdW5jdGlvbihhZGRyZXNzLCB2YWx1ZSkge1xuICAgICAgICB0aGlzLl92ZXJpZnlTdGF0dXMoKTtcbiAgICAgICAgdGhpcy5fdmVyaWZ5QmxhY2tsaXN0KGFkZHJlc3MpO1xuXG4gICAgICAgIGxldCBkYXRhID0gdGhpcy5fdm90ZS5jYWxjdWxhdGUodGhpcywgYWRkcmVzcywgdmFsdWUpO1xuICAgICAgICB0aGlzLl9wcm9kdWNlTmF0KGRhdGEpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gRGlzdHJpYnV0ZTtcbiIsICJBcmdzIjogIls2MjkxMCwgNjI5MTAsIFwibjFzeDJEVXBIb1d0c0dYcmh1cHVDQ3hVeGV1V2tZcnFWNWtcIl0ifUDXCEoQAAAAAAAAAAAAAAAEqBfIAFIQAAAAAAAAAAAAAAAAAAMNQFgBYkGhR+9frKclLx8uE5kzrnHcOhrqgXuC4qLQAyhmc/HnEmLJ64vMaRBIJiWuDPG7tLsxIwme0ipsQH37Eft/ZwHNAA==